<div>
  <form [formGroup]="searchForm">
    <table class="full-width">
      <tr>
        <td>
          <mat-form-field class="full-width">
            <mat-label>Rechercher</mat-label>
            <input matInput formControlName="search" [(ngModel)]="search" (keyup)="searchEntities()"
              (keydown)="searchEntities()" (paste)="searchEntities()">
            <button (click)="search=''" *ngIf="search!=null && search.length>0" matSuffix mat-icon-button>
              <mat-icon>close</mat-icon>
            </button>
          </mat-form-field>
        </td>
      </tr>
      <tr>
        <td>
          <div>
            <mat-tab-group animationDuration="0ms" [selectedIndex]="selectedTabIndex">
              <mat-tab [label]="getTabLabel(TIERS_ENTITY_TYPE)">
                <mat-dialog-content class="mat-content">
                  <mat-card class="pointer" *ngFor="let entity of getEntitiesForTab(TIERS_ENTITY_TYPE)"
                    (click)="openEntity(entity)">
                    <mat-card-title-group>
                      <mat-card-title>{{entity.text.denomination}} {{entity.text.firstname}} {{entity.text.lastname}}
                        ({{entity.text.id}})</mat-card-title>
                      <mat-card-subtitle>Commercial {{entity.text.salesEmployee.firstname}}
                        {{entity.text.salesEmployee.lastname}}
                        -
                        {{entity.text.address}} {{entity.text.postalCode}} {{entity.text.city.label}}
                      </mat-card-subtitle>
                      <mat-icon class="mat-card-icon">group</mat-icon>
                    </mat-card-title-group>
                  </mat-card>
                </mat-dialog-content>
              </mat-tab>
              <mat-tab [label]="getTabLabel(RESPONSABLE_ENTITY_TYPE)">
                <mat-dialog-content class="mat-content">
                  <mat-card class="pointer" *ngFor="let entity of getEntitiesForTab(RESPONSABLE_ENTITY_TYPE)"
                    (click)="openEntity(entity)">
                    <mat-card-title-group>
                      <mat-card-title>{{entity.text.firstname}} {{entity.text.lastname}}
                        ({{entity.text.id}}, Tiers {{entity.text.tiers.id}})</mat-card-title>
                      <mat-card-subtitle>Commercial {{entity.text.salesEmployee.firstname}}
                        {{entity.text.salesEmployee.lastname}}
                        -
                        {{entity.text.address}} {{entity.text.postalCode}} {{entity.text.city.label}}
                      </mat-card-subtitle>
                      <mat-icon class="mat-card-icon">group</mat-icon>
                    </mat-card-title-group>
                  </mat-card>
                </mat-dialog-content>
              </mat-tab>
              <mat-tab [label]="getTabLabel(QUOTATION_ENTITY_TYPE)">
                <mat-dialog-content class="mat-content">
                  <mat-card class="pointer" *ngFor="let entity of getEntitiesForTab(QUOTATION_ENTITY_TYPE)"
                    (click)="openEntity(entity)">
                    <mat-card-title-group>
                      <mat-card-title>{{entity.text.id}}</mat-card-title>
                      <mat-card-subtitle><span *ngIf="entity.text.tiers!=null">Pour {{entity.text.tiers.firstname}}
                          {{entity.text.tiers.lastname}}</span><span
                          *ngIf="entity.text.responsable!=null">{{entity.text.responsable.firstname}}
                          {{entity.text.responsable.lastname}}</span> - créé le {{entity.text.createdDate|
                        date:'dd/MM/yyyy à HH:mm'}}<br>Commercial <span
                          *ngIf="entity.text.tiers!=null">{{entity.text.tiers.salesEmployee.firstname}}
                          {{entity.text.tiers.salesEmployee.lastname}}</span><span
                          *ngIf="entity.text.responsable!=null">{{entity.text.responsable.salesEmployee.firstname}}
                          {{entity.text.responsable.salesEmployee.lastname}}</span>
                      </mat-card-subtitle>
                      <mat-icon class="mat-card-icon">request_quote</mat-icon>
                    </mat-card-title-group>
                  </mat-card>
                </mat-dialog-content>
              </mat-tab>
              <mat-tab [label]="getTabLabel(CUSTOMER_ORDER_ENTITY_TYPE)">
                <mat-dialog-content class="mat-content">
                  <mat-card class="pointer" *ngFor="let entity of getEntitiesForTab(CUSTOMER_ORDER_ENTITY_TYPE)"
                    (click)="openEntity(entity)">
                    <mat-card-title-group>
                      <mat-card-title>{{entity.text.id}}</mat-card-title>
                      <mat-card-subtitle><span *ngIf="entity.text.tiers!=null">Pour {{entity.text.tiers.firstname}}
                          {{entity.text.tiers.lastname}}</span><span
                          *ngIf="entity.text.responsable!=null">{{entity.text.responsable.firstname}}
                          {{entity.text.responsable.lastname}}</span> - créé le {{entity.text.createdDate|
                        date:'dd/MM/yyyy à HH:mm'}}<br>Commercial <span
                          *ngIf="entity.text.tiers!=null">{{entity.text.tiers.salesEmployee.firstname}}
                          {{entity.text.tiers.salesEmployee.lastname}}</span><span
                          *ngIf="entity.text.responsable!=null">{{entity.text.responsable.salesEmployee.firstname}}
                          {{entity.text.responsable.salesEmployee.lastname}}</span>
                      </mat-card-subtitle>
                      <mat-icon class="mat-card-icon">request_quote</mat-icon>
                    </mat-card-title-group>
                  </mat-card>
                </mat-dialog-content>
              </mat-tab>
            </mat-tab-group>
          </div>
        </td>
      </tr>
    </table>
  </form>
</div>
