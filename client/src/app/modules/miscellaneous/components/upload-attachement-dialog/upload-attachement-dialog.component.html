<div class="mat-elevation-z2 form-div mat-body" *ngIf="entity && entity.id!=undefined && entity.id!=null">
  <form [formGroup]="attachmentForm" *ngIf="entity">
    <div class="full-width container" *ngIf="file==null ">
      <input class="pointer" type="file" #fileDropRef id="fileDropRef" (change)="fileBrowseHandler($event.target)" />
      <mat-icon color="accent" class="mat-icon-upload" color="warn">file_upload</mat-icon>
      <h3>Glissez/déposez votre fichier ici</h3>
      <h3>ou</h3>
      <label for="fileDropRef" class="upload-label" color="warn">Recherchez sur votre ordinateur</label>
      <p class="max-size">(10 Mo max.)</p>
    </div>
    <select-attachment-type *ngIf="file!=null" [(model)]="attachmentType" label="Type de fichier"
      [form]="attachmentForm" propertyName="attachmentType" [isMandatory]="true"
      [isDisabled]="forcedAttachmentType!=undefined"></select-attachment-type>
    <table class="full-width">
      <tr>
        <td>
          <generic-input *ngIf="file!=null" [(model)]="filename" label="Nom du fichier" [form]="attachmentForm"
            propertyName="filename" [isMandatory]="true" [isDisabled]="false" [maxLength]="250"></generic-input>
        </td>
        <td>
          <generic-input *ngIf="file!=null && filename &&  filename.toLowerCase().substring(filename.length-3)=='pdf'"
            [(model)]="pageSelection" label="Plage de page" [form]="attachmentForm" propertyName="pageSelection"
            [isMandatory]="false" [isDisabled]="false"
            hint="Plage de pages au format 1-3,4-6 (seulement pour les fichiers non signés)"></generic-input>
        </td>
      </tr>
    </table>
    <div *ngIf="file!=null" class="list-div">
      <mat-icon color="accent" mat-list-icon (click)="deleteFile()" class="pointer"
        *ngIf="!isSending">delete_forever</mat-icon>
      <div mat-line> {{ file?.name }} ({{ formatBytes(file?.size,2) }})</div>
      <div mat-line>
        <mat-progress-bar mode="determinate" [value]="progress"></mat-progress-bar>
      </div>
    </div>
    <div align="center" class="send-button" *ngIf="file!=null && attachmentType!=null && !isSending"
      (click)="uploadFile()"> <button mat-raised-button color="warn">Uploader le fichier</button></div>
  </form>
</div>